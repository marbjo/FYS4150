\documentclass{emulateapj}
%\documentclass[12pt,preprint]{aastex}

\usepackage{graphicx}
\usepackage{float}
\usepackage{amsmath}
\usepackage{epsfig,floatflt}
\usepackage{hyperref}
\usepackage[toc, page]{appendix}
\usepackage{verbatim, amsmath, amsfonts, amssymb, amsthm}
\usepackage[utf8]{inputenc}
\usepackage{textcomp}
\usepackage{float}
\usepackage{xcolor}
\usepackage{color}
\usepackage{listings}
\usepackage{fancyhdr}
\usepackage[T1]{fontenc}
\usepackage{url}
\usepackage[export]{adjustbox}
\usepackage{calc}

\usepackage{accents}
\newcommand{\dbtilde}[1]{\accentset{\approx}{#1}}
\newcommand{\vardbtilde}[1]{\tilde{\raisebox{0pt}[0.85\height]{$\tilde{#1}$}}}

\usepackage{lipsum}
\usepackage[para]{footmisc}


\definecolor{mygreen}{rgb}{0,0.6,0}
\definecolor{mygray}{rgb}{0.5,0.5,0.5}
\definecolor{mymauve}{rgb}{0.58,0,0.82}

\lstset{ %
	backgroundcolor=\color{white}\ttfamily\tiny,   % choose the background color; you must add \usepackage{color} or \usepackage{xcolor}; should come as last argument
	basicstyle=\tiny,        % the size of the fonts that are used for the code \footnotesize,
	breakatwhitespace=false,         % sets if automatic breaks should only happen at whitespace
	columns=fullflexible,    %no spaces between columns
	keepspaces=true,
	breaklines=true,                 % sets automatic line breaking
	breakatwhitespace=true,
	captionpos=b,                    % sets the caption-position to bottom
	commentstyle=\color{mygreen},    % comment style
	deletekeywords={...},            % if you want to delete keywords from the given language
	escapeinside={\%*}{*)},          % if you want to add LaTeX within your code
	extendedchars=true,              % lets you use non-ASCII characters; for 8-bits encodings only, does not work with UTF-8
	frame=single,	                   % adds a frame around the code
	keepspaces=true,                 % keeps spaces in text, useful for keeping indentation of code (possibly needs columns=flexible)
	keywordstyle=\color{blue},       % keyword style
	language=Python,                 % the language of the code
	morekeywords={*,...},           % if you want to add more keywords to the set
	%numbers=left,                    % where to put the line-numbers; possible values are (none, left, right)
	%numbersep=5pt,                   % how far the line-numbers are from the code
	%numberstyle=\tiny\color{mygray}, % the style that is used for the line-numbers
	rulecolor=\color{black},         % if not set, the frame-color may be changed on line-breaks within not-black text (e.g. comments (green here))
	showspaces=false,                % show spaces everywhere adding particular underscores; it overrides 'showstringspaces'
	showstringspaces=false,          % underline spaces within strings only
	showtabs=false,                  % show tabs within strings adding particular underscores
	stepnumber=1,                    % the step between two line-numbers. If it's 1, each line will be numbered
	stringstyle=\color{mymauve},     % string literal style
	tabsize=1,	                   % sets default tabsize to 2 spaces
	%title=\lstname                   % show the filename of files included with \lstinputlisting; also try caption instead of title
}

\begin{document}

\title{Numerical integration - An empirical study of Gaussian quadrature and Monte Carlo}

\author{Bruce Chappell and Markus Bj√∏rklund}

\email{markus.bjorklund@astro.uio.no}

\altaffiltext{1}{Institute of Theoretical Astrophysics, University of
  Oslo, P.O.\ Box 1029 Blindern, N-0315 Oslo, Norway}

\begin{abstract}

Briefly what we are doing with what methods, and summary of the main results.

\end{abstract}
\keywords{Numerical integration --- Guassian quadrature --- Monte Carlo methods}

\section{Introduction}
\label{sec:introduction}
Brief overview of motivation, what problems we are actually solving, and overview of what is in the following sections.


\section{Theory}
\label{sec:method}


\section{Methods}
\label{sec:methods}
In this section we will describe the methods we utilized to acquire our results.
\subsection{Code}
The code used to acquire the results in this report come from the C++ program [CODE NAME!]. This file executes various numerical integration methods, runs unit tests, and prints results to text files. There is also a python file [CODE NAME!] that is used to visually interpret the resulting data.

\subsection{Algorithm}
The C++ program [CODE NAME!] solves one integration problem using four different methods: Gauss-Legendre Quadrature, a mix of Gauss-Legendre and Gauss-Laguerre Quadrature, Monte-Carlo integration using the uniform distribution, and Monte-Carlo integration using importance sampling.
\subsubsection{Quadrature}
For the less elegant Gaussian Quadrature methods, we use functions $gauss_legendre$ and $gauss_laguerre$ found in [SITE WHERE FUNCTIONS COME FROM] to calculate the integration points and weights for both Gaussian-Legendre and Gaussian-Laguerre Quadrature. Brute force Gaussian Quadrature is done using the following pseudo code.
\begin{lstlisting}[language=c++]
double brute_force(int N, double a, double b){
    double *x = new double [N];
    double *w = new double [N];
    gauss_legendre(a, b, x, w, N);
    for (int i = 0; i < N; i++){
        for (int j = 0; j < N; j++){
          for (int k = 0; k < N; k++){
            for (int l = 0; l < N; l++){
              for (int m = 0; m < N; m++){
                for (int n = 0; n < N; n++){
                  integral += w[i]*w[j]*w[k]*w[l]*w[m]*w[n]
                            * remainder(x[i],x[j],x[k],x[l],x[m],x[n]);
    }}}}}}}
\end{lstlisting}
Here we have integrated over all six spatial variable on the interval $[a,b]$ with $N$ integration points. $remainder()$ is the remaining function after dividing out the weight function from the function of interest and the selection of $a$ and $b$ will be discussed in Section \ref{subsec:parameters}. The above method is also used for solving our integral using Laguerre-Quadrature and spherical coordinates. The difference is that we use the $gauss_laguerre function$ to generate the weights for the radial dependency and the $gauss_legendre function$ to generate the weights for the angular equations.
\subsubsection{Monte-Carlo}
We used the C++ function $mt19937$ to generate the seed for our distribution sampling. We then implemented the following pseudo code for a brute force approach to Monte-Carlo integration.
\begin{lstlisting}[language=c++]
uniform_real_distribution<double> my_dist(a,b);
MCint = MCintsqr = 0;
for (int i = 1; i <= N; i++){
    x1 = my_dist(generate);
    y1 = my_dist(generate);
    z1 = my_dist(generate);
    x2 = my_dist(generate);
    y2 = my_dist(generate);
    z2 = my_dist(generate);
    fx = cartesian_f(x1,y1,z1,x2,y2,z2);
    MCint += fx;
    MCintsqr += fx*fx;
}
MCint = MCint*scale / ((double) N);
MCintsqr = MCintsqr*scale*scale / ((double) N);
double var = (MCintsqr - MCint*MCint) / ((double) N);
\end{lstlisting}
Here, the uniform distribution is used to generate all random points when solving. We must scale the resulting values by a factor of $(b-a)$ to account for a change of variables for the uniform distribution fro $[0,1]$ to $[a,b]$. To improve this method, we switched to spherical coordinates where we could exploit the exponential shape of the radial dependency and use the exponential distribution to generate the radial values. For the angular dependencies, we still used a scaled uniform distribution from $[0,\pi]$ and $[0,2\pi]$ for $\theta$ and $\phi$ respectively.
\subsection{Parameter Selection}
\label{subsec:parameters}
Since we are using numerical techniques to solve the integral described in [EQUATION], we must find a reasonable approximation for infinity. In our code, we have implemented a script to loop over $\lambda$ values until $e^{-2\alpha\lambda} < 1\times10^{-8}$ for $\alpha = 2$. The function described in [EQUATION] is radially symmetric so we will use $-\lambda$ and $\lambda$ for the upper and lower bounds when evaluating in Cartesian coordinates.
\subsection{Unit Tests}
Writing unit tests for this project proved to be slightly challenging. Since we know have the analytical answer to our integral from the start, we are essentially testing our methods each time we run the code and compare it to the analytical answer. The values of the weights and integration points are easily found in tabulated charts for both Laguerre and Legendre quadrature. In our code, we implement two tests to compare the weights and points generated by our functions compared to the tabulated values.
\subsection{Parallelization}
FUUUUUUUUUUUUUUCK
\section{Results}
\label{sec:results}


\section{Discussion}
\label{sec:discussion}


\section{Conclusions}
\label{sec:conclusions}



\subsection{Further research}


\newpage
\begin{thebibliography}{}

\bibitem{Lecture}[(Hjorth-Jensen, 2017)]{MHJ} Hjorth-Jensen, Morten \, Aug 23 2017, "Computational Physics Lectures:Numerical integration, from Newton-Cotes quadrature to Gaussian quadrature" , \url{http://compphysics.github.io/ComputationalPhysics/doc/pub/integrate/pdf/integrate-print.pdf}

\bibitem{Lecture}[(Hjorth-Jensen, 2019)]{MHJ} Hjorth-Jensen, Morten \, Oct 4 2019, "Computational Physics Lectures: Introduction to Monte Carlo methods" , \url{http://compphysics.github.io/ComputationalPhysics/doc/pub/mcint/pdf/mcint-print.pdf}

\bibitem{Project}[(Hjorth-Jensen, 2019)]{MHJ} Hjorth-Jensen, Morten \, Oct 2019, "Project 3"
\url{http://compphysics.github.io/ComputationalPhysics/doc/Projects/2019/Project3/pdf/Project3.pdf}

\end{thebibliography}

\section{Appendix}
All source code, data and figures can be found at the github repository: \url{https://github.com/marbjo/FYS4150/tree/master/Project3}

\end{document}
